<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Chrono</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" media="screen" href="main.css" />
</head>
<body>
    <script>
        showInterface = () => {
            //console.log dans une variable
            //console.log dans une variable
            cl = (e) => {console.log(e)};
            //variables globales
            let startTime = 0;
            let start = 0;
            let end = 0;
            let diff = 0;
            let timerID = 0;

            class Chrono{
                constructor(x, y, c, b){
                    this.x = x;
                    this.y = y;
                    this.c = c;
                    this.b = b;

                    this.div = document.createElement("div");
                    let div = this.div;
                        div.style.backgroundColor = this.c;
                        div.style.border = `1px solid ${this.b}`;
                        div.style.borderRadius = '20px';
                        div.style.left = this.x;
                        div.style.top = this.y;
                        div.style.width = "200px";
                        div.style.height = "80px";
                        div.style.position = "absolute";

                    this.input = document.createElement("input");
                    let input = this.input;
                        input.setAttribute("type", "text");
                        input.setAttribute("value", "00:00:00:000");
                        input.setAttribute("readOnly", "true");
                        input.style.textAlign = "center";
                        input.style.display="block";
                        input.style.margin = "0 auto";
                        input.style.marginTop = "10px";
                        
                    this.divButtons = document.createElement("div");
                    let divButtons = this.divButtons;
                        divButtons.style.display = "flex";
                        divButtons.style.justifyContent = "space-evenly";
                        divButtons.style.marginTop = "20px";

                    this.playBtn = document.createElement("img");
                    let playBtn = this.playBtn;  
                        playBtn.src = "img/play-button.png";
                        playBtn.alt = "play";

                        
                    this.pauseBtn = document.createElement("img");
                    let pauseBtn = this.pauseBtn
                        pauseBtn.src = "img/pause-button.png";
                        pauseBtn.alt = "pause";

                    this.stopBtn = document.createElement("img");
                    let stopBtn = this.stopBtn;
                        stopBtn.src = "img/stop-button.png";
                        stopBtn.alt = "stop";

                    this.playBtn.onclick = () => { this.chronoStart() };
                    this.stopBtn.onclick = () => { this.chronoReset() };
                }
                affiche(){
                    this.div.appendChild(this.input);
                    this.divButtons.appendChild(this.playBtn);
                    this.divButtons.appendChild(this.stopBtn);
                    this.div.appendChild(this.divButtons);
                    document.body.appendChild(this.div);
                }
                chrono(){
                    end = new Date();
                    diff = end - start;
                    diff = new Date(diff);
                    var msec = diff.getMilliseconds();
                    var sec = diff.getSeconds();
                    var min = diff.getMinutes();
                    var hr = diff.getHours()-1;
                    if (min < 10){
                        min = "0" + min;
                    }
                    if (sec < 10){
                        sec = "0" + sec;
                    }
                    if(msec < 10){
                        msec = "00" +msec;
                    }
                    else if(msec < 100){
                        msec = "0" +msec;
                    }
                        this.input.value = hr + ":" + min + ":" + sec + ":" + msec;
                        timerID = setTimeout(()=> {this.chrono()}, 10);
                }
                chronoStart(){
                    this.divButtons.removeChild(this.playBtn);
                    this.divButtons.removeChild(this.stopBtn);
                    this.divButtons.appendChild(this.pauseBtn);
                    this.divButtons.appendChild(this.stopBtn);
                    this.pauseBtn.onclick = () => { this.chronoStop() };
                    this.stopBtn.onclick = () => { this.chronoReset() };
                    start = new Date();
                    this.chrono();
                }
                chronoContinue(){
                    this.divButtons.removeChild(this.playBtn);
                    this.divButtons.removeChild(this.stopBtn);
                    this.divButtons.appendChild(this.pauseBtn);
                    this.divButtons.appendChild(this.stopBtn);
                    this.pauseBtn.onclick = () => { this.chronoStop() };
                    this.stopBtn.onclick = () => { this.chronoReset() } ;
                    start = new Date()-diff;
                    start = new Date(start);
                    this.chrono()
                }
                chronoReset(){
                    this.input.value = "0:00:00:000";
                    start = new Date();
                }
                chronoStopReset(){
                    this.input.value = "0:00:00:000";
                    this.playBtn.onclick = () => { this.chronoStart() };
                }
                chronoStop(){
                    this.divButtons.removeChild(this.pauseBtn);
                    this.divButtons.removeChild(this.stopBtn);
                    this.divButtons.appendChild(this.playBtn);
                    this.divButtons.appendChild(this.stopBtn);
                    this.playBtn.onclick = () => { this.chronoContinue() };
                    this.stopBtn.onclick = () => { this.chronoStopReset() };
                    clearTimeout(timerID);
                    }
            }

            let chrono1 = new Chrono("100px", "200px", "orange", "black");
            chrono1.affiche();
        }
        onload = showInterface;
    </script>
</body>
</html>